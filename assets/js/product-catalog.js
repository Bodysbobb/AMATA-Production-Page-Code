document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".product-catalog");if(!e)return;const t=!!function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}()&&{passive:!0},n="IntersectionObserver"in window?new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){const n=e.target;n.dataset.src&&(n.src=n.dataset.src,n.classList.add("loaded"),t.unobserve(n))}}))}),{rootMargin:"50px 0px",threshold:.01}):null;function o(e){return window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,0)}!function(){const t=document.querySelectorAll(".product-image");let n;if(e.dataset.imageAspectRatio)n=e.dataset.imageAspectRatio;else{const t=getComputedStyle(e);n=t.getPropertyValue("--image-aspect-ratio").trim()}n&&(e.style.setProperty("--image-aspect-ratio",n),t.forEach((e=>{e.style.aspectRatio=n})))}(),function(){const n=document.querySelector(".product-grid");if(!n)return;let o,i,a;e.dataset.imagesPerRowMax&&(o=e.dataset.imagesPerRowMax,e.style.setProperty("--images-per-row-max",o));e.dataset.imagesPerRowMin&&(i=e.dataset.imagesPerRowMin,e.style.setProperty("--images-per-row-min",i));if(e.dataset.imagesPerRow)a=e.dataset.imagesPerRow,e.style.setProperty("--images-per-row",a);else{const t=getComputedStyle(e);a=t.getPropertyValue("--images-per-row").trim(),a&&e.style.setProperty("--images-per-row",a)}function l(){let t=o||a||4;t=window.innerWidth<=576?i||1:window.innerWidth<=768?i||2:window.innerWidth<=992||window.innerWidth<=1200?Math.min(o||4,3):o||a||4,e.style.setProperty("--images-per-row",t),t&&(n.style.gridTemplateColumns=`repeat(${t}, 1fr)`)}l(),window.addEventListener("resize",function(e,t=200){let n;return function(...o){const i=this;clearTimeout(n),n=setTimeout((()=>e.apply(i,o)),t)}}(l,200),t)}();const i={copyButton:e.dataset.copyButtonLabel||"Copy URL",copyButtonFinal:e.dataset.copyButtonLabelFinalstate||"URL Copied!",copyMessage:e.dataset.copyMessageLabel||"Copy image URL:",selectedFilters:e.dataset.selectedFiltersLabel||"Selected Filters",clearAll:e.dataset.clearAllLabel||"Clear All",noFilters:e.dataset.noFiltersLabel||"No filters selected",middleLabel:e.dataset.middleLabelText||"ส่งลิงก์ผ่าน LINE ได้เลย!"},a={allowImageSave:"true"===e.dataset.allowImageSave,showCopyUrl:!("false"===e.dataset.showCopyUrl),lineAccount:e.dataset.lineAccount||"",hasGlobalSizeGuide:"true"===e.dataset.sizeGuide,globalSizeContent:e.dataset.sizeContent||"",globalSizePicture:e.dataset.sizePicture||""};!function(){if(!n)return;document.querySelectorAll(".product-image img[data-src]").forEach((t=>{if(t.classList.add("loading"),!t.width||!t.height){const n=e.dataset.imageAspectRatio;if(n){const[e,o]=n.split("/").map((e=>parseFloat(e.trim())));e&&o&&(t.style.aspectRatio=`${e} / ${o}`)}}n.observe(t)}))}();document.querySelectorAll(".filter-tag, .dropdown-filter-tag");const l=document.querySelectorAll(".product-item"),c=document.querySelector(".selected-filters-list"),s=document.querySelector(".clear-all-filters"),r=document.querySelector(".filter-sort-button"),d=document.querySelector(".filter-dropdown");let u=[];const m=document.querySelector(".selected-filters h4");m&&(m.textContent=i.selectedFilters),s&&(s.textContent=i.clearAll),document.querySelectorAll(".category-header").forEach((e=>{e.addEventListener("click",(function(){const e=this.nextElementSibling,t=this.querySelector(".arrow-icon");e.classList.toggle("hidden"),t.classList.toggle("rotated")}))})),r&&d&&(r.addEventListener("click",(function(){d.classList.toggle("active"),this.classList.toggle("active")})),document.addEventListener("click",(function(e){!e.target.closest(".filter-sort")&&d.classList.contains("active")&&(d.classList.remove("active"),r.classList.remove("active"))}))),document.addEventListener("click",(function(e){const t=e.target;if(t.matches(".filter-tag, .dropdown-filter-tag")){e.preventDefault();const n=t.getAttribute("data-filter");t.classList.contains("filter-tag")?"all"===n?u=[]:u.includes(n)?y(n):f(n):f(n),v(),b()}else if(t.classList.contains("remove-filter")){const e=t.closest(".filter-badge");e&&(y(e.dataset.filter),v(),b())}})),s&&s.addEventListener("click",(function(){u=[],v(),b()})),v();const p=document.querySelectorAll(".product-link");let g=Array.from(p),h=0;function f(e){if("all"===e)return u=[],v(),void b();u.includes(e)||u.push(e)}function y(e){u=u.filter((t=>t!==e))}function v(){c&&o((()=>{if(c.innerHTML="",0===u.length)return void(c.innerHTML=`<span class="no-filters">${i.noFilters}</span>`);const e=document.createDocumentFragment();u.forEach((t=>{const n=document.createElement("span");n.className="filter-badge",n.dataset.filter=t,n.innerHTML=`${t} <span class="remove-filter">&times;</span>`,e.appendChild(n)})),c.appendChild(e)}))}function b(){o((()=>{if(0===u.length)return l.forEach((e=>{e.style.display="block"})),void document.querySelectorAll(".filter-tag").forEach((e=>{"all"===e.getAttribute("data-filter")?e.classList.add("active"):e.classList.remove("active")}));document.querySelectorAll(".filter-tag").forEach((e=>{const t=e.getAttribute("data-filter");u.includes(t)?e.classList.add("active"):(e.classList.remove("active"),"all"===t&&e.classList.remove("active"))})),l.forEach((e=>{const t=(e.getAttribute("data-tags")||"").toLowerCase();let n=!1;for(let e=0;e<u.length;e++)if(t&&t.includes(u[e])){n=!0;break}e.style.display=n?"block":"none"}))}))}document.addEventListener("click",(function(e){const t=e.target.closest(".product-link");if(!t)return;e.preventDefault();const n=t.getAttribute("href"),o=t.getAttribute("data-title")||"",i=g.indexOf(t);-1!==i&&(h=i,L(n,o,i))})),function(){const e=window.location.search;if(e.startsWith("?")){const t=e.substring(1),n=document.querySelector(`a[data-product-slug="${t}"]`);n&&setTimeout((()=>n.click()),300)}}(),a.allowImageSave||function(){const e=CSS.supports("pointer-events","none");document.querySelectorAll(".product-image img").forEach((t=>{t.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),t.setAttribute("draggable","false"),e&&(t.style.webkitTouchCallout="none",t.style.webkitUserSelect="none",t.style.khtmlUserSelect="none",t.style.mozUserSelect="none",t.style.msUserSelect="none",t.style.userSelect="none")})),document.addEventListener("contextmenu",(e=>{if(e.target.closest(".lightbox img, .lightbox-content img"))return e.preventDefault(),!1}));let n=0;document.addEventListener("touchstart",(e=>{e.target.closest(".product-image img, .lightbox img, .lightbox-content img")&&(n=Date.now())}),t),document.addEventListener("touchend",(e=>{if(e.target.closest(".product-image img, .lightbox img, .lightbox-content img")){Date.now()-n>500&&e.preventDefault()}}),t)}();let w=null;function L(n,o,l){const c=document.createElement("div");c.className="lightbox";const s=document.createElement("div");s.className="lightbox-content";const r=document.createElement("img");r.src=n,r.alt=g[l].querySelector("img").alt;const d=g[l].querySelector("img");d.width&&d.height&&(r.width=d.width,r.height=d.height);const u=document.createElement("div");u.className="lightbox-image-wrapper",a.allowImageSave||(r.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),r.setAttribute("draggable","false"));const m=document.createElement("div");m.className="lightbox-caption",m.textContent=o,g.length>1&&function(e){const t=document.createElement("div");t.className="lightbox-nav lightbox-prev",t.innerHTML="&#10094;",t.style.opacity="0.7",t.setAttribute("aria-label","Previous image");const n=document.createElement("div");n.className="lightbox-nav lightbox-next",n.innerHTML="&#10095;",n.style.opacity="0.7",n.setAttribute("aria-label","Next image"),t.addEventListener("click",(e=>{e.stopPropagation(),E("prev")})),n.addEventListener("click",(e=>{e.stopPropagation(),E("next")})),e.appendChild(t),e.appendChild(n)}(c),a.showCopyUrl&&function(e,t){const o=document.createElement("div");o.className="lightbox-share";const l=document.createElement("div");l.className="share-message",l.textContent=i.copyMessage;const c=document.createElement("button");c.className="copy-link-button",c.textContent=i.copyButton;const s=document.createElement("div");s.className="middle-label",s.textContent=i.middleLabel,s.style.display="none";let r=null;a.lineAccount&&(r=document.createElement("a"),r.className="line-button",r.href=a.lineAccount,r.target="_blank",r.rel="noopener noreferrer",r.innerHTML='<svg class="line-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M272.1 204.2v71.1c0 1.8-1.4 3.2-3.2 3.2h-11.4c-1.1 0-2.1-.6-2.6-1.3l-32.6-44v42.2c0 1.8-1.4 3.2-3.2 3.2h-11.4c-1.8 0-3.2-1.4-3.2-3.2v-71.1c0-1.8 1.4-3.2 3.2-3.2H219c1 0 2.1.5 2.6 1.4l32.6 44v-42.2c0-1.8 1.4-3.2 3.2-3.2h11.4c1.8-.1 3.3 1.4 3.3 3.1zm-82-3.2h-11.4c-1.8 0-3.2 1.4-3.2 3.2v71.1c0 1.8 1.4 3.2 3.2 3.2h11.4c1.8 0 3.2-1.4 3.2-3.2v-71.1c0-1.7-1.4-3.2-3.2-3.2zm-27.5 59.6h-31.1v-56.4c0-1.8-1.4-3.2-3.2-3.2h-11.4c-1.8 0-3.2 1.4-3.2 3.2v71.1c0 .9.3 1.6.9 2.2.6.5 1.3.9 2.2.9h45.7c1.8 0 3.2-1.4 3.2-3.2v-11.4c0-1.7-1.4-3.2-3.1-3.2zM332.1 201h-45.7c-1.7 0-3.2 1.4-3.2 3.2v71.1c0 1.7 1.4 3.2 3.2 3.2h45.7c1.8 0 3.2-1.4 3.2-3.2v-11.4c0-1.8-1.4-3.2-3.2-3.2H301v-12h31.1c1.8 0 3.2-1.4 3.2-3.2V234c0-1.8-1.4-3.2-3.2-3.2H301v-12h31.1c1.8 0 3.2-1.4 3.2-3.2v-11.4c-.1-1.7-1.5-3.2-3.2-3.2zM448 113.7V399c-.1 44.8-36.8 81.1-81.7 81H81c-44.8-.1-81.1-36.9-81-81.7V113c.1-44.8 36.9-81.1 81.7-81H367c44.8.1 81.1 36.8 81 81.7zm-61.6 122.6c0-73-73.2-132.4-163.1-132.4-89.9 0-163.1 59.4-163.1 132.4 0 65.4 58 120.2 136.4 130.6 19.1 4.1 16.9 11.1 12.6 36.8-.7 4.1-3.3 16.1 14.1 8.8 17.4-7.3 93.9-55.3 128.2-94.7 23.6-26 34.9-52.3 34.9-81.5z"/></svg>LINE');c.addEventListener("click",(function(){const e=g[t].dataset.productSlug||"";let o=n;e&&(o=window.location.origin+window.location.pathname+"?"+e),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(o).then((()=>{c.textContent=i.copyButtonFinal,r&&(r.style.display="inline-flex"),s.style.display="inline-block",setTimeout((()=>{c.textContent=i.copyButton}),2e3)})).catch((()=>{C(o,c,r,s)})):C(o,c,r,s)})),o.appendChild(l),o.appendChild(c),o.appendChild(s),r&&o.appendChild(r);e.appendChild(o)}(u,l);const p=document.createElement("span");p.className="lightbox-close",p.innerHTML="&times;",p.setAttribute("aria-label","Close");const h=e.dataset.imageAspectRatio;if(p.style.top="1/1"===h?"30px":"10px",s.appendChild(p),u.appendChild(r),s.appendChild(u),o&&s.appendChild(m),a.hasGlobalSizeGuide&&a.globalSizeContent&&a.globalSizePicture){const e=document.createElement("div");e.className="lightbox-size-guide";const t=document.createElement("a");t.className="size-guide-link",t.href=a.globalSizePicture,t.target="_blank",t.rel="noopener noreferrer",t.textContent=a.globalSizeContent,e.appendChild(t),s.appendChild(e)}c.appendChild(s);let f=0,y=0;s.addEventListener("touchstart",(function(e){e.touches&&1===e.touches.length&&(f=e.touches[0].clientX)}),t),s.addEventListener("touchmove",(function(e){e.touches&&1===e.touches.length&&(y=e.touches[0].clientX)}),t),s.addEventListener("touchend",(function(){const e=y-f;Math.abs(e)>50&&E(e>0?"prev":"next"),f=0,y=0}),t),document.body.appendChild(c),document.body.style.overflow="hidden",w=function(e){"Escape"===e.key?x():"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||(e.preventDefault(),"ArrowLeft"===e.key?E("prev"):"ArrowRight"===e.key&&E("next"))},document.removeEventListener("keydown",w),document.addEventListener("keydown",w),p.addEventListener("click",(e=>{e.stopPropagation(),x()})),c.addEventListener("click",(e=>{e.target===c&&x()}))}function x(){w&&(document.removeEventListener("keydown",w),w=null);const e=document.querySelector(".lightbox");e?(e.style.opacity="0",e.style.transition="opacity 0.3s ease",setTimeout((()=>{e.parentNode&&document.body.removeChild(e),document.body.style.overflow=""}),300)):document.body.style.overflow=""}function E(e){let t=h;if("next"===e?t=(h+1)%g.length:"prev"===e&&(t=(h-1+g.length)%g.length),t!==h){const e=g[t],n=e.getAttribute("href"),o=e.getAttribute("data-title")||"";w&&document.removeEventListener("keydown",w);const i=document.querySelector(".lightbox");i&&document.body.removeChild(i),h=t,L(n,o,t)}}function C(e,t,n,o){const a=document.createElement("textarea");a.value=e,a.style.position="fixed",a.style.left="-9999px",a.style.top="-9999px",document.body.appendChild(a);try{a.focus(),a.select();document.execCommand("copy")?t&&(t.textContent=i.copyButtonFinal,n&&(n.style.display="inline-flex"),o&&(o.style.display="inline-block"),setTimeout((()=>{t.textContent=i.copyButton}),2e3)):t&&(t.textContent="Failed to copy")}catch(e){t&&(t.textContent="Failed to copy"),console.error("Copy fallback failed:",e)}document.body.removeChild(a)}window.addEventListener("error",(function(e){return console.error("Error in product-catalog.js:",e.message),!0})),window.addEventListener("beforeunload",(function(){const e=document.querySelector(".lightbox");e&&e.parentNode&&e.parentNode.removeChild(e),w&&document.removeEventListener("keydown",w),n&&n.disconnect()}))}));